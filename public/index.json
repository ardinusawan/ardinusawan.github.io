[{"content":"Introduction ","permalink":"http://localhost:1313/posts/auth-multi-platform/","summary":"Introduction ","title":"Auth Multi Platform for Mobile and Web"},{"content":"Introduction ","permalink":"http://localhost:1313/posts/intro-functional-programming/","summary":"Introduction ","title":"Introduction to Functional Programming"},{"content":"Introduction ","permalink":"http://localhost:1313/posts/neovim-ftw/","summary":"Introduction ","title":"Neovim ftw"},{"content":"Introduction ","permalink":"http://localhost:1313/posts/tuning-up-postgresql/","summary":"Introduction ","title":"Tuning Up Postgresql"},{"content":"Introduction If you hit https://tanggalnya.com, your request will be routed to one of this domain\nhttps://www.tanggalnya.com https://www1.tanggalnya.com https://www2.tanggalnya.com https://www3.tanggalnya.com https://www4.tanggalnya.com Except www, others is routed to my raspy / orange pi in my home.\nBut, how come? How did I expose my raspy \u0026amp; orange pi to outside world?\nArchitecture Let\u0026rsquo;s dig deeper in the architecture first\nI do split ingress to 5 of machine\nVM: www Orange Pi 5: www1 \u0026amp; www2 Raspberry Pi 4: www3 \u0026amp; www4 Here the diagrams: Details In üöÅ view, here the components:\nDNS Load Balancer Services Database Storage DNS Cloudflare is very powerfull DNS provider, here my A and CNAME record\nAs you can see, for A record it just goes to IPv4 address (Vultr Classic VM). For CNAME, it goes to cloudflared tunnel. This tunnel will expose port 80 of my pi to outside world. Will keep my Vultr instance for a while until it stable (no complain from customer üòÇ)\nWhen using dig, nothing from my pi is exposed\n‚ûú dig www1.tanggalnya.com +noall +answer -t A ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.6 \u0026lt;\u0026lt;\u0026gt;\u0026gt; www1.tanggalnya.com +noall +answer -t A ;; global options: +cmd www1.tanggalnya.com. 678 IN A 172.67.203.58 www1.tanggalnya.com. 678 IN A 104.21.52.196 Load Balancer I do use Cloudflare Worker for LB. Cloudflare Worker is serverless function (just like AWS Lambda). Here the source code for round-robin the request. I build simple load balancer with health check enabled. Do check the code for details ü§ì\nLogs: Services Before hitting my service, ingress is being handled by cloudflared first. Here the folder architecture and config Cloudflared then route the request to nginx\nMy service is consist of monorepo of Nginx + PHP üêò + JS (FE) + hasura.io as GrapqhQL API Server. Nothing much I can say\nFor accessing my server, I use tailscale. Tailscale builds on top of WireGuard by adding automatic mesh configuration, single sign-on (SSO), NAT traversal, TCP transport, and centralized Access Control Lists (ACLs). The best of it? It free up to Up to 100 devices!\nAfter connect to tailscale, then ssh to the internal ip Database Postgres. For now it just single node üòé, obviously SPOF (single point of failure) is here üò¢\nIn the future will build my own cluster DB using patroni hosted obviously in raspy/orange pi.\nStorage For storing asset we choose storj.io, but plan to migrate to Cloudflare R2 in the future (free egress ftw).\nFor image cache \u0026amp; resize service, we do use wsrv\nCaveat THIS MAIN PROJECT PURPOSE IS TO REDUCE COST AS A BOOTSTRAPPED FOUNDER ü§£ Cloudflare Worker is good enough if your traffic is low, but if you need more then better to use Argo Smart Routing for load balancer in DNS level (A record) No auto recovery üò¢. But since worker(LB) is already have health check, if 1 node goes down no traffic will be given Closing This project is mainly inspired by almigthy DHH blog. Ruby on Rails is dead, long live Ruby on Rails\nHave any question? Wanna discuss? Hit me up on ardi.nusawan13[at]gmail.com!\n","permalink":"http://localhost:1313/posts/website-in-pi/","summary":"Introduction If you hit https://tanggalnya.com, your request will be routed to one of this domain\nhttps://www.tanggalnya.com https://www1.tanggalnya.com https://www2.tanggalnya.com https://www3.tanggalnya.com https://www4.tanggalnya.com Except www, others is routed to my raspy / orange pi in my home.\nBut, how come? How did I expose my raspy \u0026amp; orange pi to outside world?\nArchitecture Let\u0026rsquo;s dig deeper in the architecture first\nI do split ingress to 5 of machine\nVM: www Orange Pi 5: www1 \u0026amp; www2 Raspberry Pi 4: www3 \u0026amp; www4 Here the diagrams: Details In üöÅ view, here the components:","title":"Host your website in raspberry/orange pi"}]